:root {
   --uom: 1rem;
   --max-aside: 4in;
   --max-article: 6.25in;
   --safari-vh-offset-ipad: 80px;
   --safari-vh-offset-iphone-portrait: 146px;
   --safari-vh-offset-iphone-landscape: 100px;
   --safe-area-inset-right: env(safe-area-inset-right, 0px);
   --safe-area-inset-left: env(safe-area-inset-left, 0px);
}

body {
   border: 0;
   margin: 0;
   padding: 0;
   display: flex;
   flex-flow: row-reverse wrap;
}

header,
aside,
article {
   border: 0;
   margin: 0;
   padding: var(--uom);
}

header {
   height: calc(100vh - calc(var(--uom) * 2));
   position: -webkit-sticky;
   position: sticky;
   top: 0;
   padding-left: calc(var(--uom) + var(--safe-area-inset-left));
}

article ~ header {
   /*          100vh - article width      - padding * 4 (for left and right padding of 2 elements) */
   width: calc(100vw - var(--max-article) - calc(var(--uom) * 4) - var(--safe-area-inset-left));
}

aside + header {
   /*          100vh - aside width      - padding * 4 (for left and right padding of 2 elements) */
   width: calc(100vw - var(--max-aside) - calc(var(--uom) * 4) - var(--safe-area-inset-left));
}

article + aside + header {
   /*          100vh - article width      - aside width      - padding * 6 (for left and right padding of 3 elements) */
   width: calc(100vw - var(--max-article) - var(--max-aside) - calc(var(--uom) * 6) - var(--safe-area-inset-left));
}

aside { 
   width: 100%;
   height: 100%;
   max-width: calc(var(--max-aside) - var(--safe-area-inset-right));
   padding-right: calc(var(--uom) + var(--safe-area-inset-right));
}

article + aside {
   max-width: var(--max-aside);
   padding-right: var(--uom);
}

article {
   min-height: 100vh;
   width: 100%;
   max-width: calc(var(--max-article) - var(--safe-area-inset-right));
   padding-right: calc(var(--uom) + var(--safe-area-inset-right));
}

article + aside {
   position: -webkit-sticky;
   position: sticky;
   top: 0;
   height: 100%;
   max-height: calc(100vh - calc(var(--uom) * 2));
   overflow: scroll;
}

/* navigation bar styling */
nav {
   margin: -1rem -1rem 0 -1rem;
   padding: 1rem 1rem 1rem 1rem;
   height: 1.5rem;
   background-color: rgba(255,255,255,.2);
}

html.hasNotchLeft header > nav {
   margin-left: calc(-1rem - var(--safe-area-inset-left));
   padding-left: calc(1rem + var(--safe-area-inset-left));
}

html.hasNotchRight article > nav {
   margin-right: calc(-1rem - var(--safe-area-inset-right));
   padding-right: calc(1rem + var(--safe-area-inset-right));
}

html.hasNotchRight aside > nav {
   margin-right: calc(-1rem - var(--safe-area-inset-right));
   padding-right: calc(1rem + var(--safe-area-inset-right));
}

aside nav,
article nav {
   background-color: #f5f5f5;
}

@media screen and (prefers-color-scheme: dark) {
   nav {
      background-color: rgba(0,0,0,.2);
   }
   aside nav,
   article nav {
      background-color: #191919;
   }
}

aside nav {
   position: -webkit-sticky;
   position: sticky;
   top: 0;
   left: 0;
   z-index: 1;
}

article + aside nav {
   position: fixed;
   top: 1rem;
   left: calc(100vw - var(--max-article) - var(--max-aside) - calc(var(--uom) * 3));
   z-index: 1;
   width: var(--max-aside);
}

article nav {
   position: -webkit-sticky;
   position: sticky;
   top: 0;
}

nav p {
   margin: 0;
   padding: 0;
   line-height: 1.5rem;
}

/* tablet landscape width and lower: hide the aside */
@media (max-width: 1700px){
   article + aside {
      display: none;
   }

   article + aside + header {
      /*          100vh - article width      - padding * 4 (for left and right padding of 2 elements) */
      width: calc(100vw - var(--max-article) - calc(var(--uom) * 4) - var(--safe-area-inset-left));
   }
}

/* hide the header when smaller than a desktop, and center the article (~< ipad tablet max portrait width 1024) */
@media (max-width: 1022px){
   article ~ header {
      display: none;
   }
   article {
      margin: 0 auto;
   }
   html.hasNotchLeft article {
      padding-left: calc(var(--uom) + var(--safe-area-inset-left));
      width: calc(var(--max-article) - var(--safe-area-inset-left))
   }
   article > nav {
      position: fixed;
      top: 1rem;
      left: 1rem;
      left: 1rem;
      padding-left: calc(var(--uom) + var(--safe-area-inset-left));
      width: 100%;
   }
}

/* mobile portrait gets stacked (header/aside).
   mobile landscape (on a very small screen) gets stacked too,
   to achieve this unset position sticky and change the flex-flow */
@media (orientation: portrait) and (max-width: 4.5in), (orientation: landscape) and (max-width: 6in) {
   body {
      flex-flow: row-reverse wrap-reverse;
   }

   /* closed styles */
   aside + header {
      width: 100%;
      position: initial;
   }

   aside {
      max-width: 100vw;
   }
}

/* Hide scrollbar for Chrome, Safari and Opera */
body::-webkit-scrollbar,
aside::-webkit-scrollbar {
   display: none;
}

/* Hide scrollbar for IE, Edge and Firefox */
body,
aside {
   -ms-overflow-style: none;  /* IE and Edge */
   scrollbar-width: none;  /* Firefox */
}








/* GHK styles (move to ghk?) */
@media (orientation: portrait) {
   body.mobile.safari > header {
      height: calc(100vh - var(--safari-vh-offset-iphone-portrait) - calc(var(--uom) * 2));
   }
}
@media (orientation: landscape) {
   body.mobile.safari > header {
      height: calc(100vh - var(--safari-vh-offset-iphone-landscape) - calc(var(--uom) * 2));
   }
}
body.tablet.safari > header {
   height: calc(100vh - var(--safari-vh-offset-ipad) - calc(var(--uom) * 2));
}

/* junk, remove styles later*/
html {
   -webkit-tap-highlight-color: transparent;
}
