:root {
   --uom: 1rem;
   --max-aside: 4in;
   --max-article: 6.25in;
   --dark-article-background: #222222ff;
   --dark-article-color: #ddddddff;
   --dark-aside-backdrop-filter: blur(8px);
   --dark-aside-background: #000000cc;
   --dark-aside-text-shaddow: 0px 0px 20px #000000ff;
   --dark-nav-fixed-background: #191919;
   --dark-nav-fixed-color: #ffffffff;
   --dark-nav-transparent-background: #00000033;
   --light-article-background: #ffffffff;
   --light-article-color: #111111ff;
   --light-aside-backdrop-filter: blur(8px);
   --light-aside-background: #ffffff66;
   --light-aside-text-shaddow: 0px 0px 20px #ffffffff;
   --light-nav-fixed-background: #f5f5f5;
   --light-nav-fixed-color: #ffffffff;
   --light-nav-transparent-background: #ffffff33;
   --light-link: #3387CC;
   --dark-link: #2573b3;
   --safe-area-inset-top: env(safe-area-inset-top, 0px);
   --safe-area-inset-right: env(safe-area-inset-right, 0px);
   --safe-area-inset-bottom: env(safe-area-inset-bottom, 0px);
   --safe-area-inset-left: env(safe-area-inset-left, 0px);
   /* --safe-area-inset-top: 44px;
   --safe-area-inset-right: 44px;
   --safe-area-inset-bottom: 44px;
   --safe-area-inset-left: 44px; */
}

body {
   border: 0;
   margin: 0;
   padding: 0;
   display: flex;
   flex-flow: row-reverse wrap;
   -webkit-text-size-adjust: 100%;
   box-sizing: initial; /* box-sizing: border-box does not work with -webkit-fill-available. It could have spared a lot of calc statements, but I tried it, doesn't work. don't bother. */
   overflow-x: hidden;
   background-color: var(--light-article-background);
   color: var(--light-article-color);
}

@media screen and (prefers-color-scheme: dark) {
   body {
      background-color: var(--dark-article-background);
      color: var(--dark-article-color);
   }
}

header,
aside,
article {
   border: 0;
   margin: 0;
   padding: calc(var(--uom) + var(--safe-area-inset-top) + calc(var(--uom) * 2) + calc(var(--uom) * 1.5)) var(--uom) calc(var(--uom) + var(--safe-area-inset-bottom)) var(--uom);
}

header {
   min-height: calc(100vh - calc(var(--uom) * 2));
   min-height: -webkit-fill-available;
   max-height: calc(100vh - calc(var(--uom) * 2) - var(--safe-area-inset-top) - var(--safe-area-inset-bottom) - calc(var(--uom) * 2) - calc(var(--uom) * 1.5));
   position: -webkit-sticky;
   position: sticky;
   top: 0;
   padding-left: calc(var(--uom) + var(--safe-area-inset-left));
   z-index: 0;
   width: 100vw;
}

header > *:not(nav, picture) {
   width: auto;
   max-width: 100%;
   box-sizing: border-box;
}

header > picture > img {
   position: absolute;
   top: 0px;
   bottom: 0px;
   left: 0px;
   right: 0px;
   z-index: -1;
   height: 100%;
   width: 100%;
   object-fit: cover;
}

header,
aside,
article > nav {
   /* https://stackoverflow.com/a/4407335/2969956 */
   -webkit-touch-callout: none !important; /* iOS Safari */
   -khtml-user-select: none !important; /* Konqueror HTML */
   -webkit-user-select: none !important; /* Safari */
   -moz-user-select: none !important; /* Old versions of Firefox */
   -ms-user-select: none !important; /* Internet Explorer/Edge */
   user-select: none !important; /* Non-prefixed version, currently supported by Chrome, Edge, Opera and Firefox */
 }

article ~ header {
   /*          100vh - article width      - padding * 4 (for left and right padding of 2 elements) */
   width: calc(100vw - var(--max-article) - calc(var(--uom) * 4) - var(--safe-area-inset-left));
}

aside + header {
   width: calc(100vw - calc(var(--uom) * 2) - var(--safe-area-inset-left));
   margin-right: calc(calc(var(--max-aside) * -1) - calc(var(--uom) * 2));
}

article + aside + header {
   width: calc(100vw - var(--max-article) - calc(var(--uom) * 4) - var(--safe-area-inset-left));
   margin-right: calc(calc(var(--max-aside) * -1) - calc(var(--uom) * 2));
}

aside {
   width: 100%;
   height: 100%;
   max-width: calc(var(--max-aside) - var(--safe-area-inset-right));
   padding-right: calc(var(--uom) + var(--safe-area-inset-right));
   z-index: 1;
   background-color: var(--light-aside-background);
   -webkit-backdrop-filter: var(--light-aside-backdrop-filter);
   backdrop-filter: var(--light-aside-backdrop-filter);
}

aside *:not(nav, pre, code, ol, ul, li) {
   text-shadow: var(--light-aside-text-shaddow);
}

@media screen and (prefers-color-scheme: dark) {
   aside *:not(nav, pre, code, ol, ul, li) {
      text-shadow: var(--dark-aside-text-shaddow);
   }
   aside {
      background-color: var(--dark-aside-background);
      -webkit-backdrop-filter: var(--dark-aside-backdrop-filter);
      backdrop-filter: var(--dark-aside-backdrop-filter);
   }
}

aside > *:not(nav) {
   width: auto;
   max-width: 100%;
   box-sizing: border-box;
}

article + aside {
   position: -webkit-sticky;
   position: sticky;
   top: 0;
   height: 100%;
   max-height: calc(100vh - calc(var(--uom) * 2) - var(--safe-area-inset-top) - var(--safe-area-inset-bottom) - calc(var(--uom) * 2) - calc(var(--uom) * 1.5));
   overflow: scroll;
   max-width: var(--max-aside);
   padding-right: var(--uom);
   min-height: calc(100vh - calc(var(--uom) * 5.5) - var(--safe-area-inset-top) - var(--safe-area-inset-bottom));
}

article {
   min-height: 100vh;
   min-height: -webkit-fill-available;
   width: 100%;
   max-width: calc(var(--max-article) - var(--safe-area-inset-right));
   padding-right: calc(var(--uom) + var(--safe-area-inset-right));
}

article > *:not(nav),
article > *:not(nav) > img {
   width: auto;
   max-width: 100%;
   box-sizing: border-box;
}

/* navigation bar styling */
nav {
   margin: calc(calc(var(--safe-area-inset-top) * -1) - var(--uom) - calc(var(--uom) * 2) - calc(var(--uom) * 1.5)) calc(var(--uom) * -1) var(--uom) calc(var(--uom) * -1);
   padding: calc(var(--uom) + var(--safe-area-inset-top)) var(--uom) var(--uom) var(--uom);
   height: calc(var(--uom) * 1.5);
   background-color: var(--light-nav-transparent-background);
   width: 100%;
   max-width: 100%;
   white-space: nowrap;
   overflow-x: auto;
   overflow-y: hidden;
   -webkit-overflow-scrolling: auto;
}

aside nav,
article nav {
   background-color: var(--light-nav-fixed-background);
}

@media screen and (prefers-color-scheme: dark) {
   nav {
      background-color: var(--dark-nav-transparent-background);
   }
   aside nav,
   article nav {
      background-color: var(--dark-nav-fixed-background);
   }
}

nav > a {
   margin: 0;
   line-height: calc(var(--uom) * 1.5);
   display: inline-block;
   padding: 0 var(--uom);
}

nav > :first-child {
   padding-left: 0;
}

nav > :last-child {
   padding-right: 0;
}

header > nav {
   margin-left: calc(calc(var(--uom) * -1) - var(--safe-area-inset-left));
   padding-left: calc(var(--uom) + var(--safe-area-inset-left));
}

aside > nav {
   position: -webkit-sticky;
   position: sticky;
   top: 0;
   left: 0;
   z-index: 1;
   margin-right: calc(calc(var(--uom) * -1) - var(--safe-area-inset-right));
   padding-right: calc(var(--uom) + var(--safe-area-inset-right));
}

article + aside > nav {
   margin-right: calc(var(--uom) * -1);
   padding-right: var(--uom);
   position: fixed;
   top: calc(var(--uom) + var(--safe-area-inset-top) + calc(var(--uom) * 2) + calc(var(--uom) * 1.5));
   left: calc(100vw - var(--max-article) - var(--max-aside) - calc(var(--uom) * 3));
   z-index: 1;
   width: calc(var(--max-aside));
}

article > nav {
   position: -webkit-sticky;
   position: sticky;
   top: 0;
   margin-right: calc(calc(var(--uom) * -1) - var(--safe-area-inset-right));
   padding-right: calc(var(--uom) + var(--safe-area-inset-right));
}

aside + header > nav {
   width: calc(100% - var(--max-aside) - calc(var(--uom) * 2));
}

/* anchor tag stylings */
a,
a:link,
a:visited,
a:active {
   text-decoration: none;
   color: var(--light-link);
   font-weight: 400;
}

a:hover {
   text-decoration: underline;
}

@media screen and (prefers-color-scheme: dark) {
   a,
   a:link,
   a:hover,
   a:visited,
   a:active {
      color: var(--dark-link);
   }
}

header > nav > a:link,
header > nav > a:hover,
header > nav > a:visited,
header > nav > a:active {
   color: var(--light-nav-fixed-color);
}

@media screen and (prefers-color-scheme: dark) {
   header > nav > a:link,
   header > nav > a:hover,
   header > nav > a:visited,
   header > nav > a:active {
      color: var(--dark-nav-fixed-color);
   }
}

/* the width of a tablet in landscape (and lower): hide the aside, override width of header to account for hidden aside */
@media (max-width: 1700px) {
   article + aside {
      display: none;
   }

   article + aside + header {
      /*          100vh - article width      - padding * 4 (for left and right padding of 2 elements) */
      width: calc(100vw - var(--max-article) - calc(var(--uom) * 4) - var(--safe-area-inset-left));
      margin-right: 0;
   }

   article + aside + header > nav {
      width: calc(100vw - var(--max-aside) - calc(var(--uom) * 2));
   }
}

/* hide the header when smaller than a desktop, and center the article (~< ipad tablet max portrait width 1024) */
@media (max-width: 1022px) {
   article ~ header {
      display: none;
   }

   article {
      width: calc(100vw - var(--safe-area-inset-left) - var(--safe-area-inset-right));
      padding-left: calc(var(--uom) + var(--safe-area-inset-left));
      max-width: initial;
   }

   article > nav {
      position: fixed;
      top: calc(var(--uom) + calc(var(--uom) * 3.5) + var(--safe-area-inset-top));
      left: var(--uom);
      padding-left: calc(var(--uom) + var(--safe-area-inset-left));
      padding-right: calc(var(--uom) + var(--safe-area-inset-right));
      width: calc(100% - calc(var(--uom) * 2) - var(--safe-area-inset-left) - var(--safe-area-inset-right));
   }

   article + aside + header > nav {
      width: 100%;
   }
}

/* mobile portrait gets stacked (header/aside).
   mobile landscape (on a very small screen) gets stacked too,
   to achieve this we: unset position sticky and change the flex-flow */
@media (orientation: portrait) and (max-width: 7.5in), (orientation: landscape) and (max-width: 7.5in) {
   body {
      flex-flow: row-reverse wrap-reverse;
   }

   aside + header {
      width: calc(100vw - calc(var(--uom) * 2));
      position: initial;
      margin-right: 0;
   }

   aside {
      max-width: calc(100vw - calc(var(--uom) * 2));
      padding-left: calc(var(--uom) + var(--safe-area-inset-left));
   }
   header > nav {
      width: calc(100vw - calc(var(--uom) * 2) - var(--safe-area-inset-left) - var(--safe-area-inset-right));
      padding-right: calc(var(--uom) + var(--safe-area-inset-right));
   }
   aside > nav {
      width: calc(100vw - calc(var(--uom) * 2) - var(--safe-area-inset-left) - var(--safe-area-inset-right));
      padding-left: calc(var(--uom) + var(--safe-area-inset-left));
      padding-right: calc(var(--uom) + var(--safe-area-inset-right));
      margin-left: calc(calc(var(--safe-area-inset-left) * -1) - var(--uom));
   }
   aside + header > nav {
      width: 100%;
   }
}

/* amp stuff */
body.amp {
   display: block;
}

body.amp > aside,
body.amp > header { /* never show the header or aside on an amp page, articles are for amp pages, not the whole site */
   display: none;
}

body.amp > article {
   margin: 0 auto;
   width: calc(100vw - var(--safe-area-inset-left) - var(--safe-area-inset-right) - calc(var(--uom) * 2));
   max-width: calc(calc(var(--max-article) * 2) - calc(var(--uom) * 2) - var(--safe-area-inset-left) - var(--safe-area-inset-right));
   padding-left: calc(var(--uom) + var(--safe-area-inset-left));
   padding-right: calc(var(--uom) + var(--safe-area-inset-right));
}

body.amp > article > nav {
   left: 0;
   right: 0;
   position: fixed;
   margin: 0;
   top: 0;
   width: calc(100vw - calc(var(--uom) * 2) - var(--safe-area-inset-left) - var(--safe-area-inset-right));
   padding-left: calc(var(--uom) + var(--safe-area-inset-left));
   padding-right: calc(var(--uom) + var(--safe-area-inset-right));
}

/* scrollbar stuff that I'm not sure works */
body::-webkit-scrollbar-track {
   box-shadow: inset 0 0 6px rgba(0,0,0,.1);
   -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,.1);
   background-color: transparent;
}

body::-webkit-scrollbar {
   background-color: transparent;
}

body::-webkit-scrollbar-thumb {
   box-shadow: inset 0 0 6px rgba(0,0,0,.3);
   -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,.3);
   background-color: transparent;
}

body::-webkit-scrollbar,
aside::-webkit-scrollbar,
article::-webkit-scrollbar { /* Hide scrollbar for Chrome, Safari and Opera */
   display: none;
}

body,
aside,
article { /* Hide scrollbar for IE, Edge and Firefox */
   -ms-overflow-style: none;  /* IE and Edge */
   scrollbar-width: none;  /* Firefox */
}

/* Print styles */
@media print {
   article > nav,
   header,
   article + aside {
      display: none !important;
   }

   article {
      width: initial;
      max-width: initial;
      padding-top: var(--uom);
   }
}